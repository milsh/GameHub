<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Snake ‚Äî Light/Dark Theme Toggle</title>
  <style>
    :root{
      /* Light theme colors */
      --bg:#f2f4f6;
      --panel:#ffffff;
      --muted:#444;
      --accent:#39ff14;
      --accent-2:#ff4da6;
      --glass: rgba(0,0,0,0.03);
      --canvas-bg:#fdfdfd;
      --grid-color:rgba(0,0,0,0.05);
      --text-primary:#000;
      --border:rgba(0,0,0,0.06);
      --shadow:rgba(0,0,0,0.15);
      --overlay:rgba(255,255,255,0.8);
      --eye-color:#001200;
    }

    [data-theme="dark"]{
      /* Dark theme colors */
      --bg:#0f1419;
      --panel:#1a1f2e;
      --muted:#a0a8b7;
      --accent:#39ff14;
      --accent-2:#ff4da6;
      --glass:rgba(255,255,255,0.03);
      --canvas-bg:#151b26;
      --grid-color:rgba(255,255,255,0.05);
      --text-primary:#ffffff;
      --border:rgba(255,255,255,0.06);
      --shadow:rgba(0,0,0,0.3);
      --overlay:rgba(0,0,0,0.8);
      --eye-color:#001200;
    }

    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial}
    body{background:linear-gradient(180deg,var(--bg), #e0e4e8);display:flex;align-items:center;justify-content:center;color:var(--muted);transition:all 0.3s ease}
    [data-theme="dark"] body{background:linear-gradient(180deg,var(--bg), #0a0e14)}
    .wrap{width:950px;max-width:95vw;padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(0,0,0,0.02), transparent);box-shadow:0 6px 30px var(--shadow);display:grid;grid-template-columns:1fr 260px;gap:16px}
    [data-theme="dark"] .wrap{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent)}
    header{grid-column:1/-1;display:flex;align-items:center;justify-content:space-between}
    h1{color:var(--text-primary);font-size:18px;margin:0}
    .meta{color:var(--muted);font-size:13px}
    .game-panel{background:var(--panel);padding:12px;border-radius:10px;display:flex;flex-direction:column;align-items:center}
    canvas{background:var(--canvas-bg);border-radius:8px;box-shadow:inset 0 0 30px rgba(0,0,0,0.06), 0 6px 24px var(--shadow)}
    .sidebar{padding:12px;background:var(--glass);border-radius:10px;display:flex;flex-direction:column;gap:10px}
    .score{background:transparent;padding:10px;border-radius:8px;border:1px solid var(--border)}
    .big{font-size:28px;color:var(--accent);font-weight:700;letter-spacing:1px}
    .label{font-size:12px;color:var(--muted)}
    .btn{padding:8px 10px;background:transparent;border:1px solid var(--border);color:var(--muted);border-radius:8px;cursor:pointer;transition:all 0.2s ease}
    .btn:hover{background:var(--glass);border-color:var(--accent-2)}
    .theme-toggle{padding:6px 8px;background:var(--panel);border:1px solid var(--border);color:var(--text-primary);border-radius:6px;cursor:pointer;font-size:12px;transition:all 0.2s ease}
    .theme-toggle:hover{background:var(--glass);border-color:var(--accent)}
    .hint{font-size:12px;color:var(--muted)}
    footer{grid-column:1/-1;text-align:center;color:var(--muted);font-size:12px;margin-top:6px}
    .small{font-size:12px;color:var(--muted)}
    .neon{color:var(--accent-2);font-weight:600}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Snake ‚Äî Light/Dark Theme</h1>
        <div class="meta">Arrow keys to control ‚Ä¢ No obstacles ‚Ä¢ Walls wrap-around</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px">
        <button id="themeToggle" class="theme-toggle">üåô Dark</button>
        <div class="meta">High score persists in your browser</div>
      </div>
    </header>

    <div class="game-panel">
      <canvas id="game" width="600" height="600"></canvas>
      <div style="height:8px"></div>
      <div class="hint">Press <span class="neon">Space</span> to pause / resume ‚Äî Press <span class="neon">R</span> to restart</div>
    </div>

    <aside class="sidebar">
      <div class="score">
        <div class="label">SCORE</div>
        <div id="score" class="big">0</div>
      </div>

      <div class="score">
        <div class="label">HIGH SCORE</div>
        <div id="highScore" class="big">0</div>
      </div>

      <div style="display:flex;gap:8px">
        <button id="restart" class="btn">Restart (R)</button>
        <button id="pauseBtn" class="btn">Pause</button>
      </div>

      <div style="margin-top:6px" class="small">
        <strong>How to play</strong>
        <p class="small">Guide the snake to eat food to grow. If the head runs into the body, the game ends. The edges wrap around so you can go through walls.</p>
      </div>

      <div class="small">Made with ‚ù§Ô∏è ‚Äî Single HTML file. Resize your window to fit.</div>
    </aside>

    <footer>Have fun!</footer>
  </div>

  <script>
    // Theme management
    const THEME_KEY = 'snakeGameTheme';
    const themeToggle = document.getElementById('themeToggle');
    
    function initTheme() {
      const savedTheme = localStorage.getItem(THEME_KEY) || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
      updateThemeButton(savedTheme);
    }
    
    function updateThemeButton(theme) {
      themeToggle.textContent = theme === 'light' ? 'üåô Dark' : '‚òÄÔ∏è Light';
    }
    
    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem(THEME_KEY, newTheme);
      updateThemeButton(newTheme);
    }
    
    themeToggle.addEventListener('click', toggleTheme);

    // Game logic
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const grid = 20;
    const cols = canvas.width / grid;
    const rows = canvas.height / grid;

    let snake = [{x: Math.floor(cols/2), y: Math.floor(rows/2)}];
    let dir = {x:1, y:0};
    let nextDir = {x:1,y:0};
    let food = null;
    let score = 0;
    const highKey = 'snakeHighScore_v1';
    let highScore = parseInt(localStorage.getItem(highKey) || '0', 10);
    let speed = 10;
    let lastTime = 0;
    let accumulated = 0;
    let paused = false;
    let gameOver = false;
    let elapsedTime = 0;

    const scoreEl = document.getElementById('score');
    const highEl = document.getElementById('highScore');
    const pauseBtn = document.getElementById('pauseBtn');
    const restartBtn = document.getElementById('restart');

    highEl.textContent = highScore;

    function getThemeColors() {
      const root = document.documentElement;
      const style = getComputedStyle(root);
      return {
        canvasBg: style.getPropertyValue('--canvas-bg').trim(),
        gridColor: style.getPropertyValue('--grid-color').trim(),
        overlay: style.getPropertyValue('--overlay').trim(),
        textPrimary: style.getPropertyValue('--text-primary').trim(),
        eyeColor: style.getPropertyValue('--eye-color').trim()
      };
    }

    function placeFood(){
      while(true){
        const x = Math.floor(Math.random()*cols);
        const y = Math.floor(Math.random()*rows);
        if(!snake.some(p => p.x===x && p.y===y)){
          food = {x,y};
          return;
        }
      }
    }

    function reset(){
      snake = [{x: Math.floor(cols/2), y: Math.floor(rows/2)}];
      dir = {x:1,y:0};
      nextDir = {x:1,y:0};
      score = 0;
      speed = 10;
      elapsedTime = 0;
      gameOver = false;
      paused = false;
      placeFood();
      updateUI();
    }

    function updateUI(){
      scoreEl.textContent = score;
      highEl.textContent = highScore;
      pauseBtn.textContent = paused ? 'Resume' : 'Pause';
    }

    function step(){
      if((nextDir.x !== -dir.x || nextDir.y !== -dir.y) || snake.length === 1){
        dir = nextDir;
      }

      const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};
      head.x = (head.x + cols) % cols;
      head.y = (head.y + rows) % rows;

      if(snake.some(s => s.x === head.x && s.y === head.y)){
        gameOver = true;
        if(score > highScore){
          highScore = score;
          localStorage.setItem(highKey, String(highScore));
        }
        updateUI();
        return;
      }

      snake.unshift(head);

      if(food && head.x === food.x && head.y === food.y){
        score += 1;
        placeFood();
      } else {
        snake.pop();
      }

      updateUI();
    }

    function draw(){
      const colors = getThemeColors();
      
      ctx.fillStyle = colors.canvasBg;
      ctx.fillRect(0,0,canvas.width,canvas.height);

      ctx.strokeStyle = colors.gridColor;
      ctx.lineWidth = 1;
      for(let i=0;i<=cols;i++){
        ctx.beginPath();ctx.moveTo(i*grid,0);ctx.lineTo(i*grid,canvas.height);ctx.stroke();
      }
      for(let j=0;j<=rows;j++){
        ctx.beginPath();ctx.moveTo(0,j*grid);ctx.lineTo(canvas.width,j*grid);ctx.stroke();
      }

      if(food){
        drawCell(food.x, food.y, '#ff4da6');
      }

      for(let i=snake.length-1;i>=0;i--){
        const p = snake[i];
        const shade = i===0 ? '#39ff14' : `rgba(57,255,20,${0.6 - i/snake.length*0.5})`;
        drawCell(p.x,p.y, shade, i===0, colors);
      }

      if(gameOver){
        ctx.fillStyle = colors.overlay;
        ctx.fillRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle = colors.textPrimary;
        ctx.font = '36px system-ui';
        ctx.textAlign = 'center';
        ctx.fillText('Game Over', canvas.width/2, canvas.height/2 - 10);
        ctx.font = '16px system-ui';
        ctx.fillText('Press R to restart', canvas.width/2, canvas.height/2 + 24);
      }
    }

    function drawCell(x,y,fill, head=false, colors=null){
      const px = x*grid;
      const py = y*grid;
      ctx.fillStyle = fill;
      roundRect(ctx, px+1, py+1, grid-2, grid-2, 6, true, false);
      if(head && colors){
        ctx.fillStyle = colors.eyeColor;
        const eyeR = 3;
        const ox = dir.x === 0 ? 6 : (dir.x > 0 ? 10 : 4);
        const oy = dir.y === 0 ? 6 : (dir.y > 0 ? 10 : 4);
        ctx.beginPath(); ctx.arc(px+ox, py+oy, eyeR, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.arc(px+grid-ox, py+grid-oy, eyeR, 0, Math.PI*2); ctx.fill();
      }
    }

    function roundRect(ctx, x, y, w, h, r, fill, stroke){
      if (w < 2 * r) r = w / 2;
      if (h < 2 * r) r = h / 2;
      ctx.beginPath();
      ctx.moveTo(x+r, y);
      ctx.arcTo(x+w, y,   x+w, y+h, r);
      ctx.arcTo(x+w, y+h, x,   y+h, r);
      ctx.arcTo(x,   y+h, x,   y,   r);
      ctx.arcTo(x,   y,   x+w, y,   r);
      ctx.closePath();
      if (fill) ctx.fill();
      if (stroke) ctx.stroke();
    }

    function loop(timestamp){
      if(!lastTime) lastTime = timestamp;
      const dt = (timestamp - lastTime) / 1000;
      elapsedTime += dt;
      if(elapsedTime >= 5 && !paused && !gameOver){
        speed += 0.2;
        elapsedTime = 0;
      }
      lastTime = timestamp;
      if(!paused && !gameOver){
        accumulated += dt;
        const interval = 1 / speed;
        while(accumulated >= interval){
          step();
          accumulated -= interval;
        }
      }
      draw();
      requestAnimationFrame(loop);
    }

    window.addEventListener('keydown', e => {
      if(gameOver && (e.key === 'r' || e.key === 'R')){
        reset();
        return;
      }
      if(e.key === ' '){
        paused = !paused;
        updateUI();
        return;
      }
      if(e.key === 'r' || e.key === 'R'){
        reset();
        return;
      }
      if(e.key === 't' || e.key === 'T'){
        toggleTheme();
        return;
      }

      switch(e.key){
        case 'ArrowUp': nextDir = {x:0,y:-1}; break;
        case 'ArrowDown': nextDir = {x:0,y:1}; break;
        case 'ArrowLeft': nextDir = {x:-1,y:0}; break;
        case 'ArrowRight': nextDir = {x:1,y:0}; break;
      }
    });

    pauseBtn.addEventListener('click', ()=>{ paused = !paused; updateUI(); });
    restartBtn.addEventListener('click', ()=>{ reset(); });

    // Initialize theme on page load
    initTheme();
    placeFood();
    updateUI();
    requestAnimationFrame(loop);
  </script>
</body>
</html>
