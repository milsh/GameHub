<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Snake ‚Äî Light/Dark Theme Toggle</title>
  <style>
    :root{
      /* Light theme colors - Vibrant Rainbow */
      --bg:linear-gradient(135deg, #ff9a8b 0%, #a8e6cf 25%, #88d8ff 50%, #ffd3a5 75%, #fd9bb4 100%);
      --panel:rgba(255,255,255,0.9);
      --muted:#2c3e50;
      --accent:#00ff88;
      --accent-2:#ff6b9d;
      --accent-3:#4ecdc4;
      --accent-4:#45b7d1;
      --glass: rgba(255,255,255,0.2);
      --canvas-bg:linear-gradient(45deg, #fff5f5 0%, #f0fff4 25%, #f0f8ff 50%, #fffacd 75%, #fff0f5 100%);
      --grid-color:rgba(255,105,180,0.1);
      --text-primary:#2c3e50;
      --border:rgba(255,105,180,0.2);
      --shadow:rgba(255,105,180,0.3);
      --overlay:rgba(255,255,255,0.85);
      --eye-color:#ff1744;
      --food-gradient:linear-gradient(45deg, #ff6b9d, #c44569);
      --snake-gradient:linear-gradient(45deg, #00ff88, #00d4aa);
    }

    [data-theme="dark"]{
      /* Dark theme colors - Cosmic Neon */
      --bg:linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
      --panel:rgba(20,20,40,0.9);
      --muted:#e0e6ff;
      --accent:#00ffff;
      --accent-2:#ff00ff;
      --accent-3:#ffff00;
      --accent-4:#ff4081;
      --glass:rgba(255,255,255,0.05);
      --canvas-bg:linear-gradient(45deg, #1a1a1a 0%, #2a2a2a 25%, #1f1f1f 50%, #353535 75%, #404040 100%);
      --grid-color:rgba(0,255,255,0.1);
      --text-primary:#ffffff;
      --border:rgba(255,0,255,0.3);
      --shadow:rgba(255,0,255,0.4);
      --overlay:rgba(0,0,0,0.85);
      --eye-color:#ff0080;
      --food-gradient:linear-gradient(45deg, #ff00ff, #8a2be2);
      --snake-gradient:linear-gradient(45deg, #00ffff, #1e90ff);
    }

    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial}
    body{background:var(--bg);display:flex;align-items:center;justify-content:center;color:var(--muted);transition:all 0.5s ease;min-height:100vh}
    [data-theme="dark"] body{animation:cosmic-pulse 3s ease-in-out infinite alternate}
    
    @keyframes cosmic-pulse {
      0% { filter: hue-rotate(0deg) saturate(1); }
      100% { filter: hue-rotate(10deg) saturate(1.1); }
    }
    
    @keyframes rainbow-shimmer {
      0% { filter: hue-rotate(0deg); }
      100% { filter: hue-rotate(360deg); }
    }
    .wrap{width:950px;max-width:95vw;padding:18px;border-radius:16px;background:var(--panel);box-shadow:0 8px 32px var(--shadow), inset 0 1px 0 rgba(255,255,255,0.2);display:grid;grid-template-columns:1fr 260px;gap:16px;backdrop-filter:blur(10px)}
    [data-theme="dark"] .wrap{box-shadow:0 8px 32px var(--shadow), 0 0 0 1px rgba(255,0,255,0.2), 0 0 20px rgba(0,255,255,0.1)}
    header{grid-column:1/-1;display:flex;align-items:center;justify-content:space-between}
    h1{color:var(--text-primary);font-size:18px;margin:0}
    .meta{color:var(--muted);font-size:13px}
    .game-panel{background:var(--panel);padding:12px;border-radius:10px;display:flex;flex-direction:column;align-items:center}
    canvas{background:var(--canvas-bg);border-radius:12px;box-shadow:inset 0 2px 10px rgba(0,0,0,0.1), 0 8px 25px var(--shadow);border:2px solid var(--border)}
    [data-theme="dark"] canvas{box-shadow:inset 0 2px 10px rgba(255,0,255,0.2), 0 8px 25px var(--shadow), 0 0 15px rgba(0,255,255,0.3)}
    .sidebar{padding:12px;background:var(--glass);border-radius:10px;display:flex;flex-direction:column;gap:10px}
    .score{background:transparent;padding:10px;border-radius:8px;border:1px solid var(--border)}
    .big{font-size:28px;color:var(--accent);font-weight:700;letter-spacing:1px}
    .label{font-size:12px;color:var(--muted)}
    .btn{padding:8px 12px;background:var(--glass);border:2px solid var(--border);color:var(--text-primary);border-radius:10px;cursor:pointer;transition:all 0.3s ease;font-weight:500}
    .btn:hover{background:var(--accent-3);color:#ffffff;border-color:var(--accent);transform:translateY(-2px);box-shadow:0 4px 15px rgba(255,105,180,0.3)}
    [data-theme="dark"] .btn:hover{background:var(--accent-2);box-shadow:0 4px 15px rgba(255,0,255,0.4)}
    .theme-toggle{padding:8px 12px;background:var(--food-gradient);border:none;color:#ffffff;border-radius:8px;cursor:pointer;font-size:12px;font-weight:600;transition:all 0.3s ease;box-shadow:0 2px 10px rgba(255,105,180,0.3)}
    .theme-toggle:hover{transform:scale(1.05) rotate(5deg);box-shadow:0 4px 20px rgba(255,105,180,0.5)}
    [data-theme="dark"] .theme-toggle{background:var(--snake-gradient);box-shadow:0 2px 10px rgba(0,255,255,0.4)}
    [data-theme="dark"] .theme-toggle:hover{box-shadow:0 4px 20px rgba(0,255,255,0.6)}
    .hint{font-size:12px;color:var(--muted)}
    footer{grid-column:1/-1;text-align:center;color:var(--muted);font-size:12px;margin-top:6px}
    .small{font-size:12px;color:var(--muted)}
    .neon{color:var(--accent-2);font-weight:600}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Snake ‚Äî Light/Dark Theme</h1>
        <div class="meta">Arrow keys to control ‚Ä¢ No obstacles ‚Ä¢ Walls wrap-around</div>
      </div>
      <div style="display:flex;align-items:center;gap:12px">
        <button id="themeToggle" class="theme-toggle">üåô Dark</button>
        <div class="meta">High score persists in your browser</div>
      </div>
    </header>

    <div class="game-panel">
      <canvas id="game" width="600" height="600"></canvas>
      <div style="height:8px"></div>
      <div class="hint">Press <span class="neon">Space</span> to pause / resume ‚Äî Press <span class="neon">R</span> to restart</div>
    </div>

    <aside class="sidebar">
      <div class="score">
        <div class="label">SCORE</div>
        <div id="score" class="big">0</div>
      </div>

      <div class="score">
        <div class="label">HIGH SCORE</div>
        <div id="highScore" class="big">0</div>
      </div>

      <div style="display:flex;gap:8px">
        <button id="restart" class="btn">Restart (R)</button>
        <button id="pauseBtn" class="btn">Pause</button>
      </div>

      <div style="margin-top:6px" class="small">
        <strong>How to play</strong>
        <p class="small">Guide the snake to eat food to grow. If the head runs into the body, the game ends. The edges wrap around so you can go through walls.</p>
      </div>

      <div class="small">Made with ‚ù§Ô∏è ‚Äî Single HTML file. Resize your window to fit.</div>
    </aside>

    <footer>Have fun!</footer>
  </div>

  <script>
    // Theme management
    const THEME_KEY = 'snakeGameTheme';
    const themeToggle = document.getElementById('themeToggle');
    
    function initTheme() {
      const savedTheme = localStorage.getItem(THEME_KEY) || 'light';
      document.documentElement.setAttribute('data-theme', savedTheme);
      updateThemeButton(savedTheme);
    }
    
    function updateThemeButton(theme) {
      themeToggle.textContent = theme === 'light' ? 'üåô Dark' : '‚òÄÔ∏è Light';
    }
    
    function toggleTheme() {
      const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      document.documentElement.setAttribute('data-theme', newTheme);
      localStorage.setItem(THEME_KEY, newTheme);
      updateThemeButton(newTheme);
    }
    
    themeToggle.addEventListener('click', toggleTheme);

    // Game logic
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const grid = 20;
    const cols = canvas.width / grid;
    const rows = canvas.height / grid;

    let snake = [{x: Math.floor(cols/2), y: Math.floor(rows/2)}];
    let dir = {x:1, y:0};
    let nextDir = {x:1,y:0};
    let food = null;
    let score = 0;
    const highKey = 'snakeHighScore_v1';
    let highScore = parseInt(localStorage.getItem(highKey) || '0', 10);
    let speed = 10;
    let lastTime = 0;
    let accumulated = 0;
    let paused = false;
    let gameOver = false;
    let elapsedTime = 0;

    const scoreEl = document.getElementById('score');
    const highEl = document.getElementById('highScore');
    const pauseBtn = document.getElementById('pauseBtn');
    const restartBtn = document.getElementById('restart');

    highEl.textContent = highScore;

    function getThemeColors() {
      const root = document.documentElement;
      const style = getComputedStyle(root);
      return {
        canvasBg: style.getPropertyValue('--canvas-bg').trim(),
        gridColor: style.getPropertyValue('--grid-color').trim(),
        overlay: style.getPropertyValue('--overlay').trim(),
        textPrimary: style.getPropertyValue('--text-primary').trim(),
        eyeColor: style.getPropertyValue('--eye-color').trim()
      };
    }

    function placeFood(){
      while(true){
        const x = Math.floor(Math.random()*cols);
        const y = Math.floor(Math.random()*rows);
        if(!snake.some(p => p.x===x && p.y===y)){
          food = {x,y};
          return;
        }
      }
    }

    function reset(){
      snake = [{x: Math.floor(cols/2), y: Math.floor(rows/2)}];
      dir = {x:1,y:0};
      nextDir = {x:1,y:0};
      score = 0;
      speed = 10;
      elapsedTime = 0;
      gameOver = false;
      paused = false;
      placeFood();
      updateUI();
    }

    function updateUI(){
      scoreEl.textContent = score;
      highEl.textContent = highScore;
      pauseBtn.textContent = paused ? 'Resume' : 'Pause';
    }

    function step(){
      if((nextDir.x !== -dir.x || nextDir.y !== -dir.y) || snake.length === 1){
        dir = nextDir;
      }

      const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};
      head.x = (head.x + cols) % cols;
      head.y = (head.y + rows) % rows;

      if(snake.some(s => s.x === head.x && s.y === head.y)){
        gameOver = true;
        if(score > highScore){
          highScore = score;
          localStorage.setItem(highKey, String(highScore));
        }
        updateUI();
        return;
      }

      snake.unshift(head);

      if(food && head.x === food.x && head.y === food.y){
        score += 1;
        placeFood();
      } else {
        snake.pop();
      }

      updateUI();
    }

    function draw(){
      const colors = getThemeColors();
      
      ctx.fillStyle = colors.canvasBg;
      ctx.fillRect(0,0,canvas.width,canvas.height);

      ctx.strokeStyle = colors.gridColor;
      ctx.lineWidth = 1;
      for(let i=0;i<=cols;i++){
        ctx.beginPath();ctx.moveTo(i*grid,0);ctx.lineTo(i*grid,canvas.height);ctx.stroke();
      }
      for(let j=0;j<=rows;j++){
        ctx.beginPath();ctx.moveTo(0,j*grid);ctx.lineTo(canvas.width,j*grid);ctx.stroke();
      }

      if(food){
        drawFood(food.x, food.y);
      }

      for(let i=snake.length-1;i>=0;i--){
        const p = snake[i];
        drawSnakeSegment(p.x, p.y, i===0, i, snake.length, colors);
      }

      if(gameOver){
        ctx.fillStyle = colors.overlay;
        ctx.fillRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle = colors.textPrimary;
        ctx.font = '36px system-ui';
        ctx.textAlign = 'center';
        ctx.fillText('Game Over', canvas.width/2, canvas.height/2 - 10);
        ctx.font = '16px system-ui';
        ctx.fillText('Press R to restart', canvas.width/2, canvas.height/2 + 24);
      }
    }

    function drawFood(x, y) {
      const px = x * grid;
      const py = y * grid;
      const centerX = px + grid / 2;
      const centerY = py + grid / 2;
      
      // Create pulsing food with gradient
      const time = Date.now() / 1000;
      const pulse = Math.sin(time * 3) * 0.1 + 0.9;
      const size = (grid - 4) * pulse;
      
      // Outer glow
      const gradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, size);
      const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
      if (isDark) {
        gradient.addColorStop(0, '#ff00ff');
        gradient.addColorStop(0.7, '#8a2be2');
        gradient.addColorStop(1, 'rgba(138, 43, 226, 0)');
      } else {
        gradient.addColorStop(0, '#ff6b9d');
        gradient.addColorStop(0.7, '#c44569');
        gradient.addColorStop(1, 'rgba(196, 69, 105, 0)');
      }
      
      ctx.fillStyle = gradient;
      ctx.beginPath();
      ctx.arc(centerX, centerY, size + 2, 0, Math.PI * 2);
      ctx.fill();
      
      // Main food body
      ctx.fillStyle = isDark ? '#ff00ff' : '#ff6b9d';
      roundRect(ctx, px + 2, py + 2, grid - 4, grid - 4, 8, true, false);
      
      // Sparkle effect
      for (let i = 0; i < 3; i++) {
        const sparkleX = centerX + Math.cos(time * 2 + i * 2) * (size / 3);
        const sparkleY = centerY + Math.sin(time * 2 + i * 2) * (size / 3);
        ctx.fillStyle = '#ffffff';
        ctx.beginPath();
        ctx.arc(sparkleX, sparkleY, 1, 0, Math.PI * 2);
        ctx.fill();
      }
    }
    
    function drawSnakeSegment(x, y, isHead, segmentIndex, totalLength, colors) {
      const px = x * grid;
      const py = y * grid;
      const centerX = px + grid / 2;
      const centerY = py + grid / 2;
      
      if (isHead) {
        // Head with gradient and glow
        const headGradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, grid/2);
        const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
        if (isDark) {
          headGradient.addColorStop(0, '#00ffff');
          headGradient.addColorStop(1, '#1e90ff');
        } else {
          headGradient.addColorStop(0, '#00ff88');
          headGradient.addColorStop(1, '#00d4aa');
        }
        
        // Outer glow for head
        const glowGradient = ctx.createRadialGradient(centerX, centerY, 0, centerX, centerY, grid);
        glowGradient.addColorStop(0, isDark ? 'rgba(0,255,255,0.3)' : 'rgba(0,255,136,0.3)');
        glowGradient.addColorStop(1, 'rgba(0,255,136,0)');
        ctx.fillStyle = glowGradient;
        ctx.beginPath();
        ctx.arc(centerX, centerY, grid, 0, Math.PI * 2);
        ctx.fill();
        
        ctx.fillStyle = headGradient;
        roundRect(ctx, px + 1, py + 1, grid - 2, grid - 2, 8, true, false);
        
        // Animated eyes
        const time = Date.now() / 1000;
        const eyeBlink = Math.sin(time * 0.5) > 0.8 ? 0.3 : 1;
        ctx.fillStyle = colors.eyeColor;
        const eyeR = 3 * eyeBlink;
        const ox = dir.x === 0 ? 6 : (dir.x > 0 ? 10 : 4);
        const oy = dir.y === 0 ? 6 : (dir.y > 0 ? 10 : 4);
        ctx.beginPath(); ctx.arc(px + ox, py + oy, eyeR, 0, Math.PI * 2); ctx.fill();
        ctx.beginPath(); ctx.arc(px + grid - ox, py + grid - oy, eyeR, 0, Math.PI * 2); ctx.fill();
        
        // Eye highlights
        ctx.fillStyle = '#ffffff';
        ctx.beginPath(); ctx.arc(px + ox + 1, py + oy - 1, eyeR * 0.4, 0, Math.PI * 2); ctx.fill();
        ctx.beginPath(); ctx.arc(px + grid - ox + 1, py + grid - oy - 1, eyeR * 0.4, 0, Math.PI * 2); ctx.fill();
      } else {
        // Body segments with color transition
        const alpha = (totalLength - segmentIndex) / totalLength;
        const hue = (segmentIndex * 20) % 360;
        const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
        
        if (isDark) {
          ctx.fillStyle = `hsl(${180 + hue}, 100%, ${50 + alpha * 30}%)`;
        } else {
          ctx.fillStyle = `hsl(${150 + hue}, 80%, ${40 + alpha * 20}%)`;
        }
        
        roundRect(ctx, px + 2, py + 2, grid - 4, grid - 4, 6, true, false);
        
        // Body shine effect
        const shineGradient = ctx.createLinearGradient(px, py, px + grid, py + grid);
        shineGradient.addColorStop(0, 'rgba(255,255,255,0.2)');
        shineGradient.addColorStop(1, 'rgba(255,255,255,0)');
        ctx.fillStyle = shineGradient;
        roundRect(ctx, px + 2, py + 2, grid - 4, grid - 4, 6, true, false);
      }
    }

    function roundRect(ctx, x, y, w, h, r, fill, stroke){
      if (w < 2 * r) r = w / 2;
      if (h < 2 * r) r = h / 2;
      ctx.beginPath();
      ctx.moveTo(x+r, y);
      ctx.arcTo(x+w, y,   x+w, y+h, r);
      ctx.arcTo(x+w, y+h, x,   y+h, r);
      ctx.arcTo(x,   y+h, x,   y,   r);
      ctx.arcTo(x,   y,   x+w, y,   r);
      ctx.closePath();
      if (fill) ctx.fill();
      if (stroke) ctx.stroke();
    }

    function loop(timestamp){
      if(!lastTime) lastTime = timestamp;
      const dt = (timestamp - lastTime) / 1000;
      elapsedTime += dt;
      if(elapsedTime >= 5 && !paused && !gameOver){
        speed += 0.2;
        elapsedTime = 0;
      }
      lastTime = timestamp;
      if(!paused && !gameOver){
        accumulated += dt;
        const interval = 1 / speed;
        while(accumulated >= interval){
          step();
          accumulated -= interval;
        }
      }
      draw();
      requestAnimationFrame(loop);
    }

    window.addEventListener('keydown', e => {
      if(gameOver && (e.key === 'r' || e.key === 'R')){
        reset();
        return;
      }
      if(e.key === ' '){
        paused = !paused;
        updateUI();
        return;
      }
      if(e.key === 'r' || e.key === 'R'){
        reset();
        return;
      }
      if(e.key === 't' || e.key === 'T'){
        toggleTheme();
        return;
      }

      switch(e.key){
        case 'ArrowUp': nextDir = {x:0,y:-1}; break;
        case 'ArrowDown': nextDir = {x:0,y:1}; break;
        case 'ArrowLeft': nextDir = {x:-1,y:0}; break;
        case 'ArrowRight': nextDir = {x:1,y:0}; break;
      }
    });

    pauseBtn.addEventListener('click', ()=>{ paused = !paused; updateUI(); });
    restartBtn.addEventListener('click', ()=>{ reset(); });

    // Initialize theme on page load
    initTheme();
    placeFood();
    updateUI();
    requestAnimationFrame(loop);
  </script>
</body>
</html>
